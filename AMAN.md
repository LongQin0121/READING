系统命名：FCFS-Based Dynamic Slot Allocation（基于先到先得的动态时隙分配）
核心内容：

完整的参数定义（ETA, ETA_early, RTA等）
详细的分配算法步骤
首架飞机的决策逻辑（何时选ETA vs ETA_early）
优化目标和成本函数


实施示例：

密集流场景：展示优化前后对比
稀疏流场景：展示无需优化的情况

# TMA合流点时隙分配策略

## 1. 系统概述

### 1.1 名称定义
**FCFS-Based Dynamic Slot Allocation (基于先到先得的动态时隙分配)**
或
**Look-Ahead Slot Optimization (前瞻式时隙优化)**

### 1.2 系统架构
- **终端区(TMA)**：分为4个独立扇区（N1, E1, S1, W1）
- **合流点(MP)**：Merging Point，多流汇聚点
- **飞机能力**：4D轨迹管理，RTA（Required Time of Arrival）能力
- **时隙间隔**：90秒/slot

---

## 2. 核心概念

### 2.1 时间参数
| 参数 | 符号 | 说明 |
|------|------|------|
| 预计到达时间 | ETA | Estimated Time of Arrival |
| 最早到达时间 | ETA_early | 飞机全速飞行的最早可能到达时间 |
| 最晚到达时间 | ETA_late | 飞机最大减速后的最晚到达时间 |
| 要求到达时间 | RTA | Required Time of Arrival（分配给飞机的目标时间）|
| 时间窗口 | TW | Time Window = [ETA_early, ETA_late] |

### 2.2 时隙参数
- **时隙间隔(S)**：90秒
- **时隙容量(C)**：1架飞机/时隙
- **时隙序列**：Slot₁, Slot₂, Slot₃, ...

---

## 3. 分配策略

### 3.1 基本原则
**先到先得(FCFS)** + **前瞻优化(Look-Ahead)**

### 3.2 分配算法

#### Step 1: 飞机排序
按ETA升序排列所有即将到达MP的飞机：
```
Aircraft_Queue = Sort_by_ETA([A₁, A₂, ..., Aₙ])
```

#### Step 2: 首架飞机RTA决策

对于**第一架飞机**，需要判断：

**判断条件：**
```
IF (ETA₂ - ETA_early₁) < S (90秒)
    THEN RTA₁ 倾向于 ETA_early₁  // 加速策略
    ELSE RTA₁ = ETA₁              // 正常策略
END IF
```

**决策逻辑：**

| 场景 | 条件 | RTA₁选择 | 理由 |
|------|------|---------|------|
| **密集流** | ETA₂ - ETA₁ < 90s | ETA_early₁ 或接近值 | 为后续飞机腾出时隙空间 |
| **稀疏流** | ETA₂ - ETA₁ ≥ 90s | ETA₁ | 无需加速，自然间隔足够 |
| **临界流** | ETA₂ - ETA_early₁ ≈ 90s | ETA_early₁ | 飞机1加速，飞机2无延误 |

#### Step 3: 后续飞机RTA分配

```
FOR i = 1 to n:
    Slotᵢ = Slotᵢ₋₁ + S (90秒)
    
    IF Slotᵢ 在飞机i的时间窗口内 [ETA_earlyᵢ, ETA_lateᵢ]:
        RTAᵢ = Slotᵢ
    ELSE IF Slotᵢ < ETA_earlyᵢ:
        RTAᵢ = ETA_earlyᵢ  // 飞机无法加速到该时隙
        重新计算后续时隙基准
    ELSE:
        冲突，需要调整
    END IF
END FOR
```

---

## 4. 优化目标

### 4.1 成本函数

**总延误成本最小化：**

```
Minimize: Σ [wᵢ × max(0, RTAᵢ - ETAᵢ)]

约束条件：
1. RTAᵢ ∈ [ETA_earlyᵢ, ETA_lateᵢ]
2. RTAᵢ₊₁ - RTAᵢ ≥ S (90秒)
3. 先到先得顺序保持
```

其中：
- wᵢ：飞机i的延误权重（可根据机型、乘客数等设定）
- 正延误：需要减速等待
- 负延误：需要加速（通常成本更低）

### 4.2 权衡分析

| 策略 | 飞机1成本 | 后续飞机成本 | 总成本 |
|------|----------|-------------|--------|
| RTA₁ = ETA₁ | 0（无加速） | 可能累积延误 | 可能较高 |
| RTA₁ = ETA_early₁ | 加速成本 | 延误减少 | 可能较低 |

---

## 5. 实施示例

### 场景1：密集流（需要优化）

**输入数据：**
```
飞机1: ETA₁ = 10:00:00, [ETA_early₁, ETA_late₁] = [09:58:00, 10:02:00]
飞机2: ETA₂ = 10:00:30, [ETA_early₂, ETA_late₂] = [09:58:30, 10:02:30]
飞机3: ETA₃ = 10:01:00, [ETA_early₃, ETA_late₃] = [09:59:00, 10:03:00]
```

**策略A：RTA₁ = ETA₁（不优化）**
```
Slot₁ = 10:00:00 → RTA₁ = 10:00:00 (飞机1延误：0秒)
Slot₂ = 10:01:30 → RTA₂ = 10:01:30 (飞机2延误：60秒)
Slot₃ = 10:03:00 → RTA₃ = 10:03:00 (飞机3延误：120秒)
总延误：180秒
```

**策略B：RTA₁ = ETA_early₁（优化）**
```
Slot₁ = 09:58:00 → RTA₁ = 09:58:00 (飞机1加速：120秒)
Slot₂ = 09:59:30 → RTA₂ = 09:59:30 (飞机2加速：60秒)
Slot₃ = 10:01:00 → RTA₃ = 10:01:00 (飞机3延误：0秒)
总时间调整：180秒（但加速成本通常低于延误成本）
```

### 场景2：稀疏流（无需优化）

**输入数据：**
```
飞机1: ETA₁ = 10:00:00
飞机2: ETA₂ = 10:02:00
```

**策略：RTA₁ = ETA₁**
```
Slot₁ = 10:00:00 → RTA₁ = 10:00:00 (延误：0秒)
Slot₂ = 10:01:30 → RTA₂ = 10:02:00 (延误：0秒，自然间隔>90s)
总延误：0秒
```

---

## 6. 系统优势

### 6.1 主要优点
1. **动态优化**：根据实时流量密度调整策略
2. **公平性**：保持FCFS顺序
3. **灵活性**：利用飞机4D-RTA能力
4. **效率**：减少整体延误

### 6.2 适用场景
- 多扇区汇聚的TMA
- 飞机具备精确4D导航能力
- 高密度流量时段
- 需要精确间隔管理的情况

---

## 7. 实施要求

### 7.1 技术要求
- ✈️ 飞机4D轨迹管理能力
- 📡 ADS-B实时位置数据
- 🖥️ 中央时隙分配系统
- 📊 ETA预测算法

### 7.2 运行要求
- 🎯 90秒时隙严格遵守
- 🔄 动态RTA更新机制
- ⚠️ 冲突检测与解决
- 📞 管制员与飞行员协同

---

## 8. 扩展考虑

### 8.1 进阶优化
- **多目标优化**：同时考虑延误、燃油、排放
- **机器学习**：基于历史数据预测最优RTA
- **滚动时域优化**：定期重新规划未分配时隙

### 8.2 特殊情况处理
- 紧急航班优先级
- 天气导致的时间窗口变化
- 飞机性能差异
- 跑道构型变化影响

---

## 参考文献
此策略基于航空交通管理中的以下概念：
- Time-Based Flow Management (TBFM)
- Point Merge System
- 4D Trajectory-Based Operations (TBO)
- Arrival Manager (AMAN) systems